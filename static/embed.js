(function(){"use strict";const a="dentalflo-chatbot-widget-iframe",d="320px",r="450px",s="52px",c={name:"Dentalflo AI Clinic",theme:{textColor:"#FFFFFF",primaryColor:"#6247ff",secondaryColor:"#92afff",backgroundColor:"#FFFFFF"},imageUrl:""};function g(){const t=l();if(t&&t.getAttribute("assistantId"))return t.getAttribute("assistantId");if(t&&t.src)try{return new URL(t.src).searchParams.get("assistantId")}catch(e){console.error("Failed to parse script URL:",e)}return null}async function f(t){try{const e=await fetch(`/api/widget-config?assistantId=${t}`);if(!e.ok)throw new Error(`Failed to fetch widget config: ${e.status}`);return await e.json()}catch(e){return console.error("Error fetching widget configuration:",e),c}}async function h(){try{if(document.getElementById(a))return console.warn("Dentalflo AI Chatbot Widget is already initialized"),null;const t=l(),e=g();e||console.warn("No assistantId provided. Widget may not function correctly.");let n=c;e&&(n=await f(e));const o=document.createElement("iframe");o.id=a,o.title=n.name||"Dentalflo AI Clinic",o.setAttribute("aria-label",n.name||"Dentalflo AI Clinic Chat Widget"),Object.assign(o.style,{position:"fixed",bottom:"16px",right:"16px",width:d,height:r,border:"none",zIndex:"2147483647",overflow:"hidden",transition:"all 0.3s ease",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0"});const i=new URL("/widget",(t==null?void 0:t.src)||window.location.href);return i.searchParams.set("t",Date.now().toString()),e&&i.searchParams.set("assistantId",e),i.searchParams.set("config",encodeURIComponent(JSON.stringify(n))),o.src=i.toString(),document.body.appendChild(o),o}catch(t){return console.error("Failed to initialize Dentalflo AI Chatbot Widget:",t),null}}function l(){if(document.currentScript)return document.currentScript;const t=document.getElementsByTagName("script");return t[t.length-1]}function u(t){const e={open:()=>{var n;t&&(t.style.height=r,(n=t.contentWindow)==null||n.postMessage("chatbot-open","*"))},close:()=>{var n;t&&(t.style.height=s,(n=t.contentWindow)==null||n.postMessage("chatbot-close","*"))},toggle:()=>{t&&(e.isOpen()?e.close():e.open())},isOpen:()=>t?t.style.height!==s:!1};return e}(async function(){try{const t=await h(),e=u(t);window.ChatbotWidget=e,window.addEventListener("message",n=>{n.data==="chatbot-widget-loaded"?console.log("Dentalflo AI Chatbot Widget loaded successfully"):n.data==="chatbot-minimize"&&t?t.style.height=s:n.data==="chatbot-expand"&&t&&(t.style.height=r)})}catch(t){console.error("Error initializing Dentalflo AI Chatbot Widget:",t)}})()})();
//# sourceMappingURL=embed.js.map
