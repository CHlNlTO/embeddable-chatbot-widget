(function(){"use strict";const l="dental-chatbot-widget-iframe",g="320px",s="450px",a="48px",d={name:"Dental Support",theme:{textColor:"#000000",primaryColor:"#FFFFFF",secondaryColor:"#E5E7EB",backgroundColor:"#FFFFFF"},imageUrl:""};function h(){const t=c();if(t&&t.getAttribute("assistantId"))return t.getAttribute("assistantId");if(t&&t.src)try{return new URL(t.src).searchParams.get("assistantId")}catch(n){console.error("Failed to parse script URL:",n)}return null}async function u(t){try{const n=c();let e="";if(n&&n.src){const o=new URL(n.src);e=`${o.protocol}//${o.host}`}else e=window.location.origin;const r=await fetch(`${e}/api/widget-config?assistantId=${t}`);if(!r.ok)throw new Error(`Failed to fetch widget config: ${r.status}`);return await r.json()}catch(n){return console.error("Error fetching widget configuration:",n),d}}async function p(){try{if(document.getElementById(l))return console.warn("Dental Chatbot Widget is already initialized"),null;const t=c(),n=window.location.hostname||"unknown",e=h();let r=d;e&&(r=await u(e));const o=document.createElement("iframe");o.id=l,o.title=r.name||"Dental Support Chat",o.setAttribute("aria-label",r.name||"Dental Support Chat Widget"),Object.assign(o.style,{position:"fixed",bottom:"16px",right:"16px",width:g,height:s,border:"none",zIndex:"2147483647",overflow:"hidden",transition:"all 0.3s ease",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)",borderRadius:"8px 8px 0 0"});const i=new URL("/widget",(t==null?void 0:t.src)||window.location.href);return i.searchParams.set("domain",n),i.searchParams.set("t",Date.now().toString()),e&&i.searchParams.set("assistantId",e),i.searchParams.set("config",encodeURIComponent(JSON.stringify(r))),o.src=i.toString(),document.body.appendChild(o),o}catch(t){return console.error("Failed to initialize Dental Chatbot Widget:",t),null}}function c(){if(document.currentScript)return document.currentScript;const t=document.getElementsByTagName("script");return t[t.length-1]}function f(t){const n={open:()=>{var e;t&&(t.style.height=s,(e=t.contentWindow)==null||e.postMessage("chatbot-open","*"))},close:()=>{var e;t&&(t.style.height=a,(e=t.contentWindow)==null||e.postMessage("chatbot-close","*"))},toggle:()=>{t&&(n.isOpen()?n.close():n.open())},isOpen:()=>t?t.style.height!==a:!1};return n}(async function(){try{const t=await p(),n=f(t);window.ChatbotWidget=n,window.addEventListener("message",e=>{e.data==="chatbot-widget-loaded"?console.log("Dental Chatbot Widget loaded successfully"):e.data==="chatbot-minimize"&&t?t.style.height=a:e.data==="chatbot-expand"&&t&&(t.style.height=s)})}catch(t){console.error("Error initializing Dental Chatbot Widget:",t)}})()})();
//# sourceMappingURL=embed.js.map
